<?xml version="1.0" encoding="UTF-8"?>
<!--
  Schema SIFEN v150 - Response Consulta Documento Electr√≥nico por CDC
  Archivo: resConsDE_v150.xsd
  Ubicaci√≥n: schemas/v150/official_set/webservices/queries/
  
  PROP√ìSITO:
  - Define la estructura del response para consultas de documentos por CDC
  - Proporciona informaci√≥n completa del documento si es encontrado
  - Maneja casos de √©xito, error y documento no encontrado
  - Facilita la interpretaci√≥n program√°tica de respuestas SIFEN
  
  OPERACI√ìN:
  - Web Service: SiConsDE (consulta documento)
  - Correlaci√≥n: Respuesta a siConsDE_v150.xsd request
  - Endpoint: https://sifen.set.gov.py/de/ws/consultas/consulta.wsdl
  - Test: https://sifen-test.set.gov.py/de/ws/consultas/consulta.wsdl
  
  C√ìDIGOS DE RESPUESTA PRINCIPALES:
  - 0280: "Consulta realizada correctamente" (documento encontrado)
  - 0420: "CDC no encontrado en el sistema" (CDC no existe)
  - 0500: "Error interno del servidor" (error temporal)
  - 0600: "Error de validaci√≥n del request" (request malformado)
  
  CASOS DE USO PRINCIPALES:
  1. Verificaci√≥n de estado de documentos emitidos
  2. Validaci√≥n de documentos recibidos de terceros
  3. Consulta de datos para integraci√≥n contable
  4. Auditor√≠a y seguimiento de documentos
  5. Verificaci√≥n pre-impresi√≥n de KuDE
  
  ESTRUCTURA CONDICIONAL:
  - gResProcCons: Solo presente si dCodRes = "0280" (documento encontrado)
  - Campos monetarios: Formato sin separadores de miles
  - Fechas: ISO 8601 est√°ndar
  
  IMPLEMENTACI√ìN RECOMENDADA:
  ```python
  # Ejemplo procesamiento response
  def procesar_consulta_de(response_xml: str) -> dict:
      tree = parse_xml(response_xml)
      codigo = tree.find('.//dCodRes').text
      
      if codigo == '0280':
          # Documento encontrado
          datos_doc = extraer_datos_documento(tree)
          return {'encontrado': True, 'documento': datos_doc}
      elif codigo == '0420':
          # Documento no encontrado
          return {'encontrado': False, 'motivo': 'CDC no existe'}
      else:
          # Error en consulta
          mensaje = tree.find('.//dMsgRes').text
          return {'error': True, 'codigo': codigo, 'mensaje': mensaje}
  ```
  
  INTEGRACI√ìN CON SCHEMAS:
  - Request: siConsDE_v150.xsd
  - Documento base: DE_v150.xsd (referencia)
  - Tipos compartidos: basic_types.xsd
  
  Autor: [Sistema]
  Fecha: 2024-06-24
  Versi√≥n: 1.5.0
  Manual: T√©cnico SIFEN v150 - Secci√≥n 4.5.2
-->

<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
    targetNamespace="http://ekuatia.set.gov.py/sifen/xsd"
    xmlns:tns="http://ekuatia.set.gov.py/sifen/xsd"
    elementFormDefault="qualified"
    attributeFormDefault="unqualified"
    version="1.5.0">

    <!-- ===================================================================== -->
    <!-- IMPORTS Y ANOTACIONES GLOBALES                                       -->
    <!-- ===================================================================== -->

    <xs:annotation>
        <xs:documentation> Schema SIFEN v150 - Response Consulta Documento Electr√≥nico por CDC
            ESTRUCTURA JER√ÅRQUICA: rRetEnviConsDe (Ra√≠z) ‚îú‚îÄ‚îÄ dFecProc (Timestamp procesamiento
            SIFEN) ‚îú‚îÄ‚îÄ dCodRes (C√≥digo resultado: 0280, 0420, etc.) ‚îú‚îÄ‚îÄ dMsgRes (Mensaje descriptivo
            resultado) ‚îî‚îÄ‚îÄ gResProcCons (Datos documento - solo si encontrado) ‚îú‚îÄ‚îÄ dFecEmi (Fecha
            emisi√≥n documento) ‚îú‚îÄ‚îÄ dRucEm/dDVEm (RUC y DV emisor) ‚îú‚îÄ‚îÄ dNomEm (Nombre emisor) ‚îú‚îÄ‚îÄ
            iTiDE (Tipo documento electr√≥nico) ‚îú‚îÄ‚îÄ dNumDoc (N√∫mero documento) ‚îú‚îÄ‚îÄ
            dTotGralOpe/dTotIVA (Totales monetarios) ‚îî‚îÄ‚îÄ cEstDE/dDesEstDE (Estado documento)
            INTERPRETACI√ìN DE C√ìDIGOS: - 0280: Documento encontrado y datos incluidos - 0420: CDC
            v√°lido pero documento no existe - 05xx: Error de autenticaci√≥n/certificado - 99xx: Error
            t√©cnico temporal del servidor VALIDACIONES AUTOM√ÅTICAS: - Correlaci√≥n con ID del request
            original - Formato de timestamp de procesamiento - Coherencia entre c√≥digo y presencia
            de datos - Validaci√≥n de tipos de datos seg√∫n especificaci√≥n CASOS ESPECIALES DE MANEJO:
            1. Documento encontrado: gResProcCons presente con todos los datos 2. Documento no
            encontrado: Solo datos de control (sin gResProcCons) 3. Error temporal: Reintentar
            consulta despu√©s de tiempo de espera 4. Error de autenticaci√≥n: Verificar certificado
            PSC </xs:documentation>
    </xs:annotation>

    <!-- ===================================================================== -->
    <!-- ELEMENTO RA√çZ DEL RESPONSE                                            -->
    <!-- ===================================================================== -->

    <xs:element name="rRetEnviConsDe" type="tns:tipoResponseConsultaDE">
        <xs:annotation>
            <xs:documentation> Elemento ra√≠z para el response de consulta de documento electr√≥nico
                CONTENIDO FIJO: - dFecProc: Timestamp del procesamiento en SIFEN - dCodRes: C√≥digo
                de resultado espec√≠fico - dMsgRes: Mensaje descriptivo del resultado CONTENIDO
                CONDICIONAL: - gResProcCons: Datos del documento (solo si dCodRes = "0280")
                CORRELACI√ìN: - Respuesta directa a request siConsDE_v150.xsd - ID de control debe
                coincidir con request original EJEMPLO DOCUMENTO ENCONTRADO: ```xml <rRetEnviConsDe
                    xmlns="http://ekuatia.set.gov.py/sifen/xsd">
                    <dFecProc>2024-06-24T15:30:45-03:00</dFecProc>
                    <dCodRes>0280</dCodRes>
                    <dMsgRes>Consulta realizada correctamente</dMsgRes>
                    <gResProcCons>
                        <dFecEmi>2024-06-24</dFecEmi>
                        <dRucEm>12345678</dRucEm>
                        <dDVEm>9</dDVEm>
                        <dNomEm>Empresa Ejemplo SAE</dNomEm>
                        <iTiDE>1</iTiDE>
                        <dNumDoc>0000001</dNumDoc>
                        <dTotGralOpe>110000</dTotGralOpe>
                        <dTotIVA>10000</dTotIVA>
                        <cEstDE>1</cEstDE>
                        <dDesEstDE>Aprobado</dDesEstDE>
                    </gResProcCons>
                </rRetEnviConsDe>
                ``` EJEMPLO DOCUMENTO NO ENCONTRADO: ```xml <rRetEnviConsDe
                    xmlns="http://ekuatia.set.gov.py/sifen/xsd">
                    <dFecProc>2024-06-24T15:30:45-03:00</dFecProc>
                    <dCodRes>0420</dCodRes>
                    <dMsgRes>CDC no encontrado en el sistema</dMsgRes>
                    <!-- Sin gResProcCons -->
                </rRetEnviConsDe>
                ``` </xs:documentation>
        </xs:annotation>
    </xs:element>

    <!-- ===================================================================== -->
    <!-- TIPO COMPLEJO PRINCIPAL                                               -->
    <!-- ===================================================================== -->

    <xs:complexType name="tipoResponseConsultaDE">
        <xs:annotation>
            <xs:documentation> Tipo complejo que define la estructura completa del response CAMPOS
                OBLIGATORIOS (siempre presentes): - dFecProc: Fecha y hora del procesamiento en
                SIFEN - dCodRes: C√≥digo espec√≠fico del resultado - dMsgRes: Mensaje descriptivo del
                c√≥digo CAMPOS CONDICIONALES: - gResProcCons: Datos del documento (solo si c√≥digo =
                0280) L√ìGICA DE NEGOCIO: - Si dCodRes = "0280": gResProcCons DEBE estar presente -
                Si dCodRes ‚â† "0280": gResProcCons NO debe estar presente - Todos los campos son
                validados seg√∫n tipos espec√≠ficos PROCESAMIENTO RECOMENDADO: 1. Verificar dCodRes
                para determinar √©xito/fallo 2. Si √©xito (0280): procesar datos en gResProcCons 3. Si
                fallo: usar dMsgRes para manejo de errores 4. Loggar siempre dFecProc para auditor√≠a </xs:documentation>
        </xs:annotation>

        <xs:sequence>

            <!-- Fecha y hora de procesamiento -->
            <xs:element name="dFecProc" type="tns:tipoTimestampProcesamiento">
                <xs:annotation>
                    <xs:documentation> Fecha y hora exacta del procesamiento en SIFEN
                        CARACTER√çSTICAS: - Tipo: DateTime con timezone - Formato: ISO 8601 completo
                        (YYYY-MM-DDThh:mm:ss¬±TZ) - Timezone: America/Asuncion (-03:00 est√°ndar,
                        -04:00 DST) - Precisi√≥n: Segundos (sin milisegundos) PROP√ìSITO: - Timestamp
                        oficial del procesamiento - Auditor√≠a y trazabilidad de operaciones -
                        Correlaci√≥n temporal con logs SIFEN - Verificaci√≥n de tiempos de respuesta
                        VALIDACIONES: - Fecha no puede ser futura - Debe incluir timezone v√°lido de
                        Paraguay - Formato estricto ISO 8601 EJEMPLOS V√ÅLIDOS: -
                        2024-06-24T15:30:45-03:00 (horario est√°ndar) - 2024-12-15T09:15:30-04:00
                        (horario de verano) USO EN LOGS: Usar este timestamp para correlacionar con
                        logs internos y determinar tiempos de procesamiento </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- C√≥digo de resultado -->
            <xs:element name="dCodRes" type="tns:tipoCodigoResultadoConsulta">
                <xs:annotation>
                    <xs:documentation> C√≥digo espec√≠fico del resultado de la consulta C√ìDIGOS
                        PRINCIPALES: üü¢ √âXITO: - 0280: "Consulta realizada correctamente" Documento
                        encontrado y datos incluidos üü° DOCUMENTO NO ENCONTRADO: - 0420: "CDC no
                        encontrado en el sistema" CDC v√°lido pero documento no existe üî¥ ERRORES DE
                        VALIDACI√ìN: - 0600: "Error de validaci√≥n del request" Request malformado o
                        CDC inv√°lido - 0610: "Par√°metros de consulta inv√°lidos" Formato de CDC
                        incorrecto üî¥ ERRORES DE AUTENTICACI√ìN: - 0500: "Error de autenticaci√≥n"
                        Certificado PSC inv√°lido o expirado - 0510: "Acceso no autorizado" Sin
                        permisos para consultar üî¥ ERRORES T√âCNICOS: - 9900: "Error interno del
                        servidor" Error temporal, reintentar - 9910: "Servicio temporalmente no
                        disponible" Mantenimiento programado MANEJO PROGRAM√ÅTICO: ```python def
                        manejar_codigo_respuesta(codigo: str): if codigo == '0280': return
                        'EXITO_DOCUMENTO_ENCONTRADO' elif codigo == '0420': return
                        'DOCUMENTO_NO_ENCONTRADO' elif codigo.startswith('06'): return
                        'ERROR_VALIDACION' elif codigo.startswith('05'): return
                        'ERROR_AUTENTICACION' elif codigo.startswith('99'): return 'ERROR_TEMPORAL'
                        else: return 'ERROR_DESCONOCIDO' ``` </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- Mensaje descriptivo -->
            <xs:element name="dMsgRes" type="tns:tipoMensajeResultado">
                <xs:annotation>
                    <xs:documentation> Mensaje descriptivo que complementa el c√≥digo de resultado
                        CARACTER√çSTICAS: - Texto en espa√±ol legible para humanos - Longitud variable
                        (10-200 caracteres t√≠pico) - Coherente con el c√≥digo dCodRes - Sin
                        informaci√≥n sensible MENSAJES T√çPICOS POR C√ìDIGO: - 0280: "Consulta
                        realizada correctamente" - 0420: "CDC no encontrado en el sistema" - 0600:
                        "Error de validaci√≥n del request" - 0500: "Error de autenticaci√≥n del
                        certificado" - 9900: "Error interno del servidor, intente nuevamente"
                        PROP√ìSITO: - Informaci√≥n legible para usuarios finales - Contexto adicional
                        para debugging - Mensajes para mostrar en interfaces - Logs y auditor√≠a
                        descriptiva USO RECOMENDADO: - Para UI: Mostrar al usuario final - Para
                        logs: Complementar el c√≥digo t√©cnico - Para debugging: Informaci√≥n adicional
                        del error - No usar para l√≥gica de negocio (usar dCodRes) NOTA IMPORTANTE:
                        El contenido exacto puede variar entre versiones de SIFEN, siempre usar
                        dCodRes para l√≥gica de negocio </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- Datos del documento consultado (condicional) -->
            <xs:element name="gResProcCons" type="tns:tipoInformacionDocumento" minOccurs="0">
                <xs:annotation>
                    <xs:documentation> Grupo con informaci√≥n del documento consultado
                        CONDICIONALIDAD ESTRICTA: - PRESENTE: Solo cuando dCodRes = "0280" -
                        AUSENTE: En cualquier otro c√≥digo de resultado - OBLIGATORIO: Si documento
                        existe y consulta es exitosa CONTENIDO INCLUIDO: - Informaci√≥n b√°sica del
                        emisor (RUC, nombre) - Tipo y n√∫mero del documento - Fecha de emisi√≥n
                        original - Totales monetarios principales - Estado actual del documento en
                        SIFEN INFORMACI√ìN EXCLUIDA (no incluida): - Items detallados del documento -
                        Informaci√≥n del receptor - Firma digital completa - Campos espec√≠ficos por
                        tipo de documento VALIDACI√ìN AUTOM√ÅTICA: - Parser debe verificar coherencia:
                        c√≥digo 0280 = datos presentes - Todos los subcampos son obligatorios si el
                        grupo est√° presente - Tipos de datos seg√∫n especificaci√≥n SIFEN USO T√çPICO:
                        ```python if response.dCodRes == '0280': documento = response.gResProcCons
                        print(f"Documento {documento.iTiDE} #{documento.dNumDoc}") print(f"Emisor:
                        {documento.dNomEm} ({documento.dRucEm})") print(f"Total:
                        {documento.dTotGralOpe} ({documento.dDesEstDE})") ``` </xs:documentation>
                </xs:annotation>
            </xs:element>

        </xs:sequence>

        <!-- Atributo de versi√≥n -->
        <xs:attribute name="version" type="xs:string" fixed="1.5.0">
            <xs:annotation>
                <xs:documentation> Versi√≥n del schema de response utilizado VALOR FIJO: "1.5.0"
                    PROP√ìSITO: Identificar versi√≥n para compatibilidad y parsing USO: Autom√°tico por
                    el sistema </xs:documentation>
            </xs:annotation>
        </xs:attribute>

    </xs:complexType>

    <!-- ===================================================================== -->
    <!-- TIPO COMPLEJO PARA INFORMACI√ìN DEL DOCUMENTO                         -->
    <!-- ===================================================================== -->

    <xs:complexType name="tipoInformacionDocumento">
        <xs:annotation>
            <xs:documentation> Informaci√≥n b√°sica del documento electr√≥nico consultado PROP√ìSITO: -
                Proporcionar datos esenciales del documento - Permitir verificaci√≥n de autenticidad
                - Facilitar integraci√≥n con sistemas contables - Mostrar estado actual en SIFEN
                CAMPOS INCLUIDOS: Todos los campos son obligatorios si el grupo est√° presente. La
                informaci√≥n refleja el estado actual en SIFEN. ACTUALIZACI√ìN: Los datos se obtienen
                en tiempo real del sistema SIFEN, reflejando el estado m√°s actual del documento. </xs:documentation>
        </xs:annotation>

        <xs:sequence>

            <!-- Fecha de emisi√≥n del documento -->
            <xs:element name="dFecEmi" type="tns:tipoFechaEmision">
                <xs:annotation>
                    <xs:documentation> Fecha de emisi√≥n original del documento electr√≥nico
                        CARACTER√çSTICAS: - Tipo: Date (solo fecha, sin hora) - Formato: YYYY-MM-DD
                        (ISO 8601) - Inmutable: No cambia despu√©s de emisi√≥n - Obligatorio: Siempre
                        presente en documentos v√°lidos PROP√ìSITO: - Identificar cu√°ndo fue emitido
                        el documento - Validar plazos de transmisi√≥n y vigencia - Ordenamiento
                        cronol√≥gico de documentos - Auditor√≠a y control fiscal VALIDACIONES: - No
                        puede ser fecha futura - Debe ser coherente con per√≠odo fiscal - Formato
                        estricto YYYY-MM-DD EJEMPLO: 2024-06-24 </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- RUC del emisor -->
            <xs:element name="dRucEm" type="tns:tipoRUCEmisor">
                <xs:annotation>
                    <xs:documentation> RUC del emisor del documento (sin d√≠gito verificador)
                        CARACTER√çSTICAS: - Longitud: Exactamente 8 d√≠gitos num√©ricos - Sin guiones
                        ni separadores - Sin d√≠gito verificador (se incluye en dDVEm) -
                        Identificador √∫nico del contribuyente emisor VALIDACI√ìN: - Solo d√≠gitos 0-9
                        - Longitud exacta 8 caracteres - Debe existir en padr√≥n RUC de SET -
                        Coherente con certificado PSC usado para firmar EJEMPLO: 12345678 </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- D√≠gito verificador del RUC -->
            <xs:element name="dDVEm" type="tns:tipoDigitoVerificador">
                <xs:annotation>
                    <xs:documentation> D√≠gito verificador del RUC del emisor CARACTER√çSTICAS: -
                        Longitud: 1 d√≠gito num√©rico (0-9) - Calculado con algoritmo m√≥dulo 11 -
                        Validaci√≥n autom√°tica de integridad del RUC C√ÅLCULO: Algoritmo m√≥dulo 11
                        aplicado sobre los 8 d√≠gitos del RUC VALIDACI√ìN: - Debe coincidir con
                        c√°lculo sobre dRucEm - Valor 0-9 √∫nicamente EJEMPLO: 9 (para RUC 12345678) </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- Nombre del emisor -->
            <xs:element name="dNomEm" type="tns:tipoNombreEmisor">
                <xs:annotation>
                    <xs:documentation> Nombre o raz√≥n social del emisor CARACTER√çSTICAS: - Longitud:
                        4-60 caracteres - Texto libre alfanum√©rico - Seg√∫n registro oficial en SET -
                        Inmutable durante vigencia del documento CONTENIDO: - Personas f√≠sicas:
                        Nombre completo - Personas jur√≠dicas: Raz√≥n social oficial - Sin
                        abreviaciones no oficiales EJEMPLO: "Empresa Ejemplo Sociedad An√≥nima" </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- Tipo de documento electr√≥nico -->
            <xs:element name="iTiDE" type="tns:tipoDocumentoElectronico">
                <xs:annotation>
                    <xs:documentation> Tipo de documento electr√≥nico VALORES V√ÅLIDOS: - 1: Factura
                        Electr√≥nica (FE) - 4: Autofactura Electr√≥nica (AFE) - 5: Nota de Cr√©dito
                        Electr√≥nica (NCE) - 6: Nota de D√©bito Electr√≥nica (NDE) - 7: Nota de
                        Remisi√≥n Electr√≥nica (NRE) PROP√ìSITO: - Identificar la naturaleza del
                        documento - Determinar reglas de validaci√≥n aplicables - Facilitar
                        procesamiento espec√≠fico por tipo INMUTABLE: El tipo no cambia una vez
                        emitido el documento EJEMPLO: 1 (Factura Electr√≥nica) </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- N√∫mero del documento -->
            <xs:element name="dNumDoc" type="tns:tipoNumeroDocumento">
                <xs:annotation>
                    <xs:documentation> N√∫mero secuencial del documento CARACTER√çSTICAS: - Longitud:
                        7 d√≠gitos num√©ricos - Completar con ceros a la izquierda - Secuencial por
                        establecimiento y punto expedici√≥n - √önico dentro del timbrado espec√≠fico
                        FORMATO: - Siempre 7 d√≠gitos: 0000001, 0000002, etc. - Sin separadores ni
                        caracteres especiales VALIDACI√ìN: - Rango: 0000001 a 9999999 - Secuencial
                        dentro del timbrado - No debe estar duplicado EJEMPLO: 0000001 </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- Total general de la operaci√≥n -->
            <xs:element name="dTotGralOpe" type="tns:tipoMontoTotal">
                <xs:annotation>
                    <xs:documentation> Total general de la operaci√≥n (monto final) CARACTER√çSTICAS:
                        - Tipo: Decimal con hasta 2 decimales - Sin separadores de miles en XML -
                        Incluye IVA y todos los conceptos - Moneda seg√∫n documento original C√ÅLCULO:
                        - Subtotal gravado + IVA + otros conceptos - Menos descuentos globales -
                        Monto final a pagar FORMATO XML: - Sin comas ni puntos de miles - Punto
                        decimal para centavos - Ejemplo: 110000.50 (ciento diez mil guaran√≠es con 50
                        c√©ntimos) VALIDACI√ìN: - Debe ser mayor que 0 - Coherente con dTotIVA y otros
                        subtotales - M√°ximo 15 d√≠gitos enteros + 2 decimales EJEMPLO: 110000 (ciento
                        diez mil guaran√≠es) </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- Total de IVA -->
            <xs:element name="dTotIVA" type="tns:tipoMontoIVA">
                <xs:annotation>
                    <xs:documentation> Total de IVA incluido en la operaci√≥n CARACTER√çSTICAS: -
                        Tipo: Decimal con hasta 2 decimales - Sin separadores de miles en XML - Suma
                        de IVA 5% + IVA 10% + otros - Puede ser 0 para operaciones exentas C√ÅLCULO:
                        - Suma de todos los IVA por tasa - IVA 5% + IVA 10% + IVA Comisi√≥n - Solo el
                        componente IVA, sin la base gravada VALIDACI√ìN: - Debe ser >= 0 - No puede
                        exceder dTotGralOpe - Coherente con bases gravadas informadas EJEMPLO: 10000
                        (diez mil guaran√≠es de IVA) </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- Estado del documento en SIFEN -->
            <xs:element name="cEstDE" type="tns:tipoCodigoEstadoDocumento">
                <xs:annotation>
                    <xs:documentation> C√≥digo del estado actual del documento en SIFEN VALORES
                        POSIBLES: - 1: Aprobado (documento v√°lido y autorizado) - 2: Aprobado con
                        observaci√≥n (v√°lido pero con observaciones) - 3: Rechazado (documento no
                        v√°lido) - 4: Cancelado (documento anulado por el emisor) INMUTABILIDAD: -
                        Estados 1 y 2: No cambian (documentos v√°lidos) - Estado 3: No cambia
                        (rechazo definitivo) - Estado 4: Resultado de evento de cancelaci√≥n
                        IMPLICACIONES: - Estado 1/2: Documento fiscal v√°lido - Estado 3: Sin valor
                        fiscal - Estado 4: Anulado oficialmente EJEMPLO: 1 (Aprobado) </xs:documentation>
                </xs:annotation>
            </xs:element>

            <!-- Descripci√≥n del estado -->
            <xs:element name="dDesEstDE" type="tns:tipoDescripcionEstado">
                <xs:annotation>
                    <xs:documentation> Descripci√≥n textual del estado del documento VALORES
                        CORRESPONDIENTES: - "Aprobado": Para cEstDE = 1 - "Aprobado con
                        observaci√≥n": Para cEstDE = 2 - "Rechazado": Para cEstDE = 3 - "Cancelado":
                        Para cEstDE = 4 CARACTER√çSTICAS: - Texto fijo seg√∫n c√≥digo de estado - En
                        espa√±ol, legible para usuarios - Coherente con cEstDE siempre - Inmutable
                        seg√∫n estado PROP√ìSITO: - Mostrar en interfaces de usuario - Reportes e
                        impresiones legibles - Logs descriptivos - Auditor√≠a textual VALIDACI√ìN
                        AUTOM√ÅTICA: - Debe corresponder exactamente con cEstDE - Texto est√°ndar sin
                        variaciones EJEMPLO: "Aprobado" </xs:documentation>
                </xs:annotation>
            </xs:element>

        </xs:sequence>
    </xs:complexType>

    <!-- ===================================================================== -->
    <!-- TIPOS SIMPLES AUXILIARES                                             -->
    <!-- ===================================================================== -->

    <!-- Tipo para timestamp de procesamiento -->
    <xs:simpleType name="tipoTimestampProcesamiento">
        <xs:annotation>
            <xs:documentation> Tipo para fecha y hora de procesamiento en SIFEN CARACTER√çSTICAS: -
                Base: dateTime con timezone obligatorio - Timezone: America/Asuncion (-03:00 o
                -04:00) - Precisi√≥n: Segundos (sin milisegundos) - Formato: YYYY-MM-DDThh:mm:ss¬±TZ
                VALIDACI√ìN: - Debe incluir timezone v√°lido - No puede ser fecha futura - Formato ISO
                8601 estricto </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:dateTime">
            <xs:pattern value="\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}[+-]\d{2}:\d{2}" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para c√≥digo de resultado de consulta -->
    <xs:simpleType name="tipoCodigoResultadoConsulta">
        <xs:annotation>
            <xs:documentation> C√≥digo espec√≠fico del resultado de consulta C√ìDIGOS V√ÅLIDOS: - 0280:
                Consulta exitosa, documento encontrado - 0420: CDC no encontrado - 05xx: Errores de
                autenticaci√≥n - 06xx: Errores de validaci√≥n - 99xx: Errores t√©cnicos temporales
                FORMATO: - 4 d√≠gitos num√©ricos exactos - Sin espacios ni caracteres especiales </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:string">
            <xs:pattern value="[0-9]{4}" />
            <xs:length value="4" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para mensaje de resultado -->
    <xs:simpleType name="tipoMensajeResultado">
        <xs:annotation>
            <xs:documentation> Mensaje descriptivo del resultado CARACTER√çSTICAS: - Texto en espa√±ol
                - Longitud variable 10-200 caracteres - Sin informaci√≥n sensible - Coherente con
                c√≥digo de resultado </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:string">
            <xs:minLength value="10" />
            <xs:maxLength value="200" />
            <xs:whiteSpace value="collapse" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para fecha de emisi√≥n -->
    <xs:simpleType name="tipoFechaEmision">
        <xs:annotation>
            <xs:documentation> Fecha de emisi√≥n del documento (solo fecha, sin hora) FORMATO:
                YYYY-MM-DD VALIDACI√ìN: No puede ser fecha futura </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:date">
            <xs:pattern value="\d{4}-\d{2}-\d{2}" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para RUC del emisor -->
    <xs:simpleType name="tipoRUCEmisor">
        <xs:annotation>
            <xs:documentation> RUC del emisor (sin d√≠gito verificador) CARACTER√çSTICAS: -
                Exactamente 8 d√≠gitos num√©ricos - Sin separadores ni espacios - Sin d√≠gito
                verificador </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:string">
            <xs:pattern value="[0-9]{8}" />
            <xs:length value="8" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para d√≠gito verificador -->
    <xs:simpleType name="tipoDigitoVerificador">
        <xs:annotation>
            <xs:documentation> D√≠gito verificador calculado con m√≥dulo 11 CARACTER√çSTICAS: - 1
                d√≠gito num√©rico (0-9) - Calculado autom√°ticamente - Validaci√≥n de integridad del RUC </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:string">
            <xs:pattern value="[0-9]" />
            <xs:length value="1" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para nombre del emisor -->
    <xs:simpleType name="tipoNombreEmisor">
        <xs:annotation>
            <xs:documentation> Nombre o raz√≥n social del emisor CARACTER√çSTICAS: - Longitud: 4-60
                caracteres - Alfanum√©rico con espacios permitidos - Seg√∫n registro oficial en SET </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:string">
            <xs:minLength value="4" />
            <xs:maxLength value="60" />
            <xs:whiteSpace value="collapse" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para tipo de documento electr√≥nico -->
    <xs:simpleType name="tipoDocumentoElectronico">
        <xs:annotation>
            <xs:documentation> Tipo de documento electr√≥nico seg√∫n especificaci√≥n SIFEN VALORES
                V√ÅLIDOS: - 1: Factura Electr√≥nica (FE) - 4: Autofactura Electr√≥nica (AFE) - 5: Nota
                de Cr√©dito Electr√≥nica (NCE) - 6: Nota de D√©bito Electr√≥nica (NDE) - 7: Nota de
                Remisi√≥n Electr√≥nica (NRE) </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:positiveInteger">
            <xs:enumeration value="1" />
            <xs:enumeration value="4" />
            <xs:enumeration value="5" />
            <xs:enumeration value="6" />
            <xs:enumeration value="7" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para n√∫mero de documento -->
    <xs:simpleType name="tipoNumeroDocumento">
        <xs:annotation>
            <xs:documentation> N√∫mero secuencial del documento CARACTER√çSTICAS: - 7 d√≠gitos
                num√©ricos exactos - Completar con ceros a la izquierda - Rango: 0000001 a 9999999 </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:string">
            <xs:pattern value="[0-9]{7}" />
            <xs:length value="7" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para montos totales -->
    <xs:simpleType name="tipoMontoTotal">
        <xs:annotation>
            <xs:documentation> Monto total de la operaci√≥n CARACTER√çSTICAS: - Decimal con hasta 2
                decimales - Sin separadores de miles en XML - Valor m√≠nimo: 0 - M√°ximo: 15 d√≠gitos
                enteros + 2 decimales </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:decimal">
            <xs:minInclusive value="0" />
            <xs:fractionDigits value="2" />
            <xs:totalDigits value="17" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para monto de IVA -->
    <xs:simpleType name="tipoMontoIVA">
        <xs:annotation>
            <xs:documentation> Monto total de IVA CARACTER√çSTICAS: - Decimal con hasta 2 decimales -
                Sin separadores de miles en XML - Valor m√≠nimo: 0 (puede ser 0 para exentos) -
                M√°ximo: 15 d√≠gitos enteros + 2 decimales </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:decimal">
            <xs:minInclusive value="0" />
            <xs:fractionDigits value="2" />
            <xs:totalDigits value="17" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para c√≥digo de estado del documento -->
    <xs:simpleType name="tipoCodigoEstadoDocumento">
        <xs:annotation>
            <xs:documentation> C√≥digo del estado del documento en SIFEN VALORES V√ÅLIDOS: - 1:
                Aprobado - 2: Aprobado con observaci√≥n - 3: Rechazado - 4: Cancelado </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:positiveInteger">
            <xs:enumeration value="1" />
            <xs:enumeration value="2" />
            <xs:enumeration value="3" />
            <xs:enumeration value="4" />
        </xs:restriction>
    </xs:simpleType>

    <!-- Tipo para descripci√≥n del estado -->
    <xs:simpleType name="tipoDescripcionEstado">
        <xs:annotation>
            <xs:documentation> Descripci√≥n textual del estado del documento VALORES FIJOS: -
                "Aprobado" - "Aprobado con observaci√≥n" - "Rechazado" - "Cancelado" </xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:string">
            <xs:enumeration value="Aprobado" />
            <xs:enumeration value="Aprobado con observaci√≥n" />
            <xs:enumeration value="Rechazado" />
            <xs:enumeration value="Cancelado" />
        </xs:restriction>
    </xs:simpleType>

    <!-- ===================================================================== -->
    <!-- TIPOS PARA AN√ÅLISIS Y DEBUGGING                                      -->
    <!-- ===================================================================== -->

    <!-- Tipo auxiliar para an√°lisis de response -->
    <xs:complexType name="tipoAnalisisResponse">
        <xs:annotation>
            <xs:documentation> Tipo auxiliar para an√°lisis program√°tico de responses USOS: - Parsing
                automatizado de respuestas - Clasificaci√≥n de resultados por tipo - Testing
                automatizado de casos - Generaci√≥n de reportes y estad√≠sticas NO INCLUIR EN
                RESPONSES REALES Solo para an√°lisis interno y desarrollo </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="exitoso" type="xs:boolean">
                <xs:annotation>
                    <xs:documentation> Indica si la consulta fue exitosa true: dCodRes = 0280
                        (documento encontrado) false: cualquier otro c√≥digo </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="documentoEncontrado" type="xs:boolean">
                <xs:annotation>
                    <xs:documentation> Indica si el documento fue encontrado true: dCodRes = 0280
                        false: dCodRes = 0420 o error </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="categoriaResultado" type="xs:string">
                <xs:annotation>
                    <xs:documentation> Categor√≠a del resultado para m√©tricas Valores: "encontrado",
                        "no_encontrado", "error_validacion", "error_autenticacion", "error_tecnico" </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="tiempoRespuesta" type="xs:duration" minOccurs="0">
                <xs:annotation>
                    <xs:documentation> Tiempo de respuesta del servicio Para m√©tricas de performance </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
    </xs:complexType>

    <!-- Tipo para m√©tricas de uso -->
    <xs:complexType name="tipoMetricasConsulta">
        <xs:annotation>
            <xs:documentation> M√©tricas de uso para an√°lisis estad√≠stico PROP√ìSITO: - An√°lisis de
                patrones de consulta - Optimizaci√≥n de performance - Monitoreo de sistema - Reportes
                de uso </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="tipoDocumentoConsultado" type="tns:tipoDocumentoElectronico"
                minOccurs="0">
                <xs:annotation>
                    <xs:documentation>Tipo de documento m√°s consultado</xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="antiguedadDocumento" type="xs:int" minOccurs="0">
                <xs:annotation>
                    <xs:documentation>D√≠as desde emisi√≥n del documento consultado</xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="origenConsulta" type="xs:string" minOccurs="0">
                <xs:annotation>
                    <xs:documentation>Origen de la consulta: "emisor", "receptor", "tercero"</xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
    </xs:complexType>

</xs:schema>